<Window x:Class="Daz_Package_Manager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Daz_Package_Manager" xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:properties="clr-namespace:Daz_Package_Manager.Properties"
        mc:Ignorable="d"
        Title="MainWindow" Height="1200" Width="1500">
    <Window.Resources >
        <DataTemplate x:Key="SelectCheckbox">
            <CheckBox Width="Auto" IsChecked="{Binding Path=Selected, UpdateSourceTrigger=PropertyChanged}" />
        </DataTemplate>
        <DataTemplate x:Key="ImageBox">
            <Image Height="150" Source="{Binding Image}" />
        </DataTemplate>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition />
        </Grid.ColumnDefinitions>
        <Grid Grid.Row="0" Grid.Column="0" Margin="5 5">
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row="0" Grid.Column="0" Text="Step 1: " Margin="5 5"/>
            <Button Grid.Row="0" Grid.Column="1" Click="SelectInstallManifestFolder" Margin="5 5">Select Install Manifest Archive Folder</Button>
            <TextBox Grid.Row="0" Grid.Column="2" Name="InstallManifestFolderBox" DataContext="{x:Static properties:Settings.Default}" Text="{Binding InstallManifestFolder}" IsReadOnly="True" Margin="5 5"/>

            <TextBlock Grid.Row="1" Grid.Column="0" Text="Step 2: " Margin="5 5"/>
            <Button Grid.Row="1" Grid.Column="1" Click="ScanInstallManifestFolder" Margin="5 5">Scan Install Manifest Archive</Button>

            <TextBlock Grid.Row="2" Grid.Column="0" Text="Step 3: " Margin="5 5"/>
            <Button Grid.Row="2" Grid.Column="1" Click="SelectSceneFile" Margin="5 5">Select Scene File(Optional)</Button>
            <TextBox Grid.Row="2" Grid.Column="2" Name="SceneFileLocation" DataContext="{x:Static properties:Settings.Default}" Text="{Binding SceneFile}" IsReadOnly="True" Margin="5 5"/>

            <TextBlock Grid.Row="3" Grid.Column="0" Text="Step 4: " Margin="5 5"/>
            <Button Grid.Row="3" Grid.Column="1" Click="SelectFigureBasedOnScene" Margin="5 5" Padding="5,2">Select Package Based On Scene (Optional)</Button>

            <TextBlock Grid.Row="4" Grid.Column="0" Text="Step 5: " Margin="5 5"/>
            <Button Grid.Row="4" Grid.Column="1" Click="SelectOutputFolder" Margin="5 5">Select Output Folder Location</Button>
            <TextBox Grid.Row="4" Grid.Column="2" Name="OutputFolder" DataContext="{x:Static properties:Settings.Default}" Text="{Binding OutputFolder}" IsReadOnly="True" Margin="5 5"/>

            <TextBlock Grid.Row="5" Grid.Column="0" Text="Step 6: " Margin="5 5"/>
            <Button Grid.Row="5" Grid.Column="1" Click="GenerateVirtualInstallFolder" Margin="5 5">Generate Virtual Install Folder</Button>
        </Grid>

        <Grid Grid.Row="0" Grid.Column="1" Margin="5 5">
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Button Grid.Row="0" Grid.Column="0" Click="SelectCacheLocation" Margin="5 5">Select Where To Save Cache File</Button>
            <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="100" Name="CacheLocation" DataContext="{x:Static properties:Settings.Default}" Text="{Binding CacheLocation}" IsReadOnly="True" Margin="5 5"/>

            <Button Grid.Row="1" Grid.Column="0" Click="ClearPackageSelection" Margin="5 5">Clear Package Selection</Button>
            <Button Grid.Row="1" Grid.Column="1" Click="CallLoadCache" Margin="5 5" Visibility="Visible">Reload Cache</Button>
            <Button Grid.Row="1" Grid.Column="2" Click="ClearDebugLogHandler" Margin="5 5">Clear Log</Button>

            <CheckBox Grid.Row="2" Grid.Column="0" Margin="5 5" Checked ="SaveUserSetting" Unchecked="SaveUserSetting"
                      DataContext="{x:Static properties:Settings.Default}" 
                      IsChecked="{Binding UseSceneSubfolder}">
                Create Subfolder based on Scene Name
            </CheckBox>
        </Grid>

        <TabControl Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2">
            <TabItem Header="Packages">
                <DataGrid Name="PackageDisplay" ItemsSource="{Binding PackagesViewSource.View}" IsReadOnly="False" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="Select" Width="Auto" IsReadOnly="True" CellTemplate="{StaticResource SelectCheckbox}"/>
                        <DataGridTextColumn Header="Package Name" Binding="{Binding ProductName}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Installed Location" Binding="{Binding InstalledLocation}" IsReadOnly="True"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <TabItem Header="Figures">
                <DataGrid Name="CharactersDisplay" ItemsSource="{Binding CharactersViewSource.View}" IsReadOnly="False" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="Select" Width="Auto" IsReadOnly="True" CellTemplate="{StaticResource SelectCheckbox}"/>
                        <DataGridTemplateColumn Header="Image" Width="SizeToCells" IsReadOnly="True" CellTemplate="{StaticResource ImageBox}"/>
                        <DataGridTextColumn Header="Figure Location" Binding="{Binding Path}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Product Name" Binding="{Binding ProductName}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Generation" Binding="{Binding Generation}" IsReadOnly="True"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <TabItem Header="Poses">
                <DataGrid Name="PosesDisplay" ItemsSource="{Binding PosesViewSource.View}" IsReadOnly="False" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="Select" Width="Auto" IsReadOnly="True" CellTemplate="{StaticResource SelectCheckbox}"/>
                        <DataGridTemplateColumn Header="Image" Width="SizeToCells" IsReadOnly="True" CellTemplate="{StaticResource ImageBox}"/>
                        <DataGridTextColumn Header="Figure Location" Binding="{Binding Path}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Product Name" Binding="{Binding ProductName}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Generation" Binding="{Binding Generation}" IsReadOnly="True"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <TabItem Header="Log Output">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Row="0" Text="Logs:" />
                    <Button Grid.Row="0" Grid.Column="1" Margin="5 5" Click="ClearDebugLogHandler">
                        Clear Log
                    </Button>
                    <ScrollViewer Grid.Row="1" Grid.ColumnSpan="100 "
                          VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Visible">
                        <RichTextBox  Name="DebugRtb"
					  Background="LightGray"
                      Grid.Row="1"
                      ScrollViewer.VerticalScrollBarVisibility="Visible" ScrollViewer.HorizontalScrollBarVisibility="Visible">
                            <FlowDocument Name="DebugText" PageWidth="{Binding ElementName=DebugRtb, Path=ActualWidth}" />
                        </RichTextBox>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
        </TabControl>
        
    </Grid>
</Window>
